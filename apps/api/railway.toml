[build]
buildCommand = "pnpm install --frozen-lockfile && pnpm --filter @cartback/shared build && cd apps/api && node --import tsx ace.js build --no-install && cp -r ../../node_modules build/"

[deploy]
startCommand = "cd apps/api/build && npm ci --omit=dev && node bin/server.js"
restartPolicyType = "on_failure"
restartPolicyMaxRetries = 10

[healthcheck]
path = "/health"
timeout = 100
interval = 60
